<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>GPS 定位</title>
  <script src="sdk.js"></script>
</head>
<body>
  <h2 id="gps">当前位置: 加载中...</h2>

  <script>
    // ⚠️ 填写你的 Master API Key 和 设备ID
    var api = new OneNetApi("tIEbQvV3+u9IZvVwlIZZtZ10F8QmEeU12Koqjx30StqQBBVXMtkqdmgDY4+mCZBw");
    var deviceId = 2469496646;

    // 定时刷新 GPS 数据
    function loadGPS() {
      api.getDataStreams(deviceId).done(function(res) {
        console.log("返回：", res);

        if (res.data && res.data.length > 0) {
          var gpsStream = res.data.find(s => s.id === "GPS");
          if (gpsStream && gpsStream.current_value) {
            var gps = gpsStream.current_value;
            document.getElementById("gps").innerHTML =
              "当前位置: 经度 " + gps.lon + " , 纬度 " + gps.lat;
          } else {
            document.getElementById("gps").innerHTML = "当前位置: 无GPS数据";
          }
        } else {
          document.getElementById("gps").innerHTML = "当前位置: 无数据";
        }
      });
    }

    // 首次加载 + 每 10 秒刷新一次
    loadGPS();
    setInterval(loadGPS, 10000);
  </script>
</body>
</html>
