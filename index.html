<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GPS轨迹</title>
<script src="https://webapi.amap.com/maps?v=2.0&key=你的高德Key"></script>
</head>
<body>
<h2>GPS轨迹</h2>
<div id="mapContainer" style="width:100%;height:500px;"></div>

<script>
async function fetchGPS() {
    const res = await fetch("/api/gps");
    const data = await res.json();
    return data;
}

function showMap(points) {
    const map = new AMap.Map('mapContainer', {
        zoom: 5,
        center: [points[0].lon, points[0].lat]
    });

    const path = points.map(p => [p.lon, p.lat]);

    new AMap.Polyline({
        map: map,
        path: path,
        borderWeight: 2,
        strokeColor: "#FF0000",
        lineJoin: 'round'
    });

    points.forEach(p => {
        new AMap.Marker({
            map: map,
            position: [p.lon, p.lat],
            title: p.time
        });
    });
}

fetchGPS().then(showMap);
</script>
</body>
</html>
